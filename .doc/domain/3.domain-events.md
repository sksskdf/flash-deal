# Domain Events

Aggregate에서 발생한 중요한 사건. 과거형으로 표현.



## 1. 이벤트 구조

### 공통 필드
```javascript
// DomainEvent
{
    eventId: String;     // UUID
    eventType: String;   // "OrderCreated"
    occurredAt: Date;    // 발생 시각
    aggregateId: String; // 발행자
}
```

## 2. Product 이벤트

### DealStarted

upcoming → active
```javascript
// DealStartedEvent extends DomainEvent
{
    productId: String;
    startedAt: Date;
}
```

### DealEnded

active → ended
```javascript
// DealEndedEvent extends DomainEvent 
{
    productId: String;
    endedAt: Date;
}
```

### ProductSoldOut

active → soldout
```javascript
// ProductSoldOutEvent extends DomainEvent 
{
    productId: String;
    soldOutAt: Date;
}
```

## 3. Inventory 이벤트

### StockDecreased

```javascript
// StockDecreasedEvent extends DomainEvent 
{
    inventoryId: String;
    productId: String;
    quantity: Number;
    remainingStock: Number;
}
```

### StockReserved

주문 생성 시 발생
```javascript
// StockReservedEvent extends DomainEvent 
{
    inventoryId: String;
    productId: String;
    orderId: String;
    quantity: Number;
    expiresAt: Date;
}
```

### ReservationConfirmed

결제 완료 시 발생
```javascript
// ReservationConfirmedEvent extends DomainEvent 
{
    inventoryId: String;
    orderId: String;
    quantity: Number;
}
```

### ReservationReleased

취소/타임아웃 시 발생
```javascript
// ReservationReleasedEvent extends DomainEvent 
{
    inventoryId: String;
    orderId: String;
    quantity: Number;
    reason: String;
}
```



## 4. Order 이벤트

### OrderCreated

```javascript
// OrderCreatedEvent extends DomainEvent 
{
    orderId: String;
    userId: String;
    items: OrderItem[];
    total: Number;
}
```

### OrderConfirmed

```javascript
// OrderConfirmedEvent extends DomainEvent 
{
    orderId: String;
    transactionId: String;
    confirmedAt: Date;
}
```

### OrderCancelled

```javascript
// OrderCancelledEvent extends DomainEvent 
{
    orderId: String;
    reason: String;
    cancelledBy: String;
}
```

### PaymentCompleted

```javascript
// PaymentCompletedEvent extends DomainEvent 
{
    orderId: String;
    amount: Number;
    transactionId: String;
    paymentMethod: String;
}
```

### PaymentFailed

```javascript
// PaymentFailedEvent extends DomainEvent 
{
    orderId: String;
    errorCode: String;
    errorMessage: String;
}
```